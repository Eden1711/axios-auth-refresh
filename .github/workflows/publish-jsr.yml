name: Publish to JSR

on:
  push:
    tags:
      - "v*"

jobs:
  publish:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      id-token: write

    steps:
      - uses: actions/checkout@v4

      # ğŸ‘‡ THÃŠM BÆ¯á»šC NÃ€Y: DÃ¹ng lá»‡nh sed Ä‘á»ƒ xÃ³a Ä‘oáº¡n declare module khá»i file src/index.ts
      # Lá»‡nh nÃ y tÃ¬m dÃ²ng chá»©a "declare module" Ä‘áº¿n dáº¥u "}" Ä‘Ã³ng vÃ  xÃ³a nÃ³ Ä‘i
      - name: Remove Global Types for JSR compatibility
        run: |
          sed -i '/declare module "axios" {/,/}/d' src/index.ts
          cat src/index.ts # In ra Ä‘á»ƒ kiá»ƒm tra xem Ä‘Ã£ xÃ³a chÆ°a (Optional)

      - name: Publish to JSR
        run: npx jsr publish --allow-slow-types
